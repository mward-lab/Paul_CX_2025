---
title: "Total Reads by Individual"
author: "Your Name"
date: "`r Sys.Date()`"
output: workflowr::wflow_html
---

```{r setup, include=FALSE}
source("analysis/_setup.R")  # Load global setup script
```


## **üìç Define Color Palettes**
```{r define-colors, echo=TRUE}
# Define color palette for individuals
Ind_palc <- c("#ffbe0b","#ff006e","#fb5607", "#8338ec","#3a86ff","#4a4e69")
```


## **üìç Load dataset for total reads by individual**
```{r load-data-individual, echo=TRUE, message=FALSE}
# Load dataset for total reads by individual
align2 <- read.csv("data/Total_number_of_reads_by_Individuals.csv")  # Ensure this file is inside the 'data/' folder
map2 <- data.frame(align2)
```

## **üìç Generate the boxplot**
```{r generate_boxplot, echo=TRUE, message=FALSE}
# Generate the boxplot
p_individual <- ggplot(map2, aes(x = Ind, y = Counts, fill = Individual)) +
  geom_boxplot() +
  scale_fill_manual(values = Ind_palc) +
  scale_y_continuous(
    limits = c(0, 40000000),  # Set y-axis range
    labels = function(x) paste0(x / 1e6, "M")  # Display labels in millions
  ) +
  ggtitle(expression("Total number of reads by individual")) +
  xlab("") +
  ylab(expression("RNA-sequencing reads")) +
  theme_bw() +
  theme(
    plot.title = element_text(size = rel(2), hjust = 0.5),
    axis.title = element_text(size = 15, color = "black"),
    axis.text.x = element_text(size = 10, angle = 90, hjust = 1, vjust = 0.2)
  )

# Save the plot as an image
ggsave("output/total_reads_by_individual_plot.png", p_individual)

# Display the plot in the document
p_individual
```
