---
title: "Total Reads by Sample"
author: "Your Name"
date: "`r Sys.Date()`"
output: workflowr::wflow_html
---

## Total Reads by Sample

This section visualizes the total RNA-sequencing reads across samples.

---

### **Load Required Libraries**
```{r libraries, echo=TRUE}
# Load necessary R packages
library(limma)
library(RColorBrewer)
library(data.table)
library(tidyverse)
library(scales)
library(ggplot2)
library(dplyr)
```

## **üìç 2. Load Data**
```{r load-data, echo=TRUE, message=FALSE}
# Load the dataset containing the total reads per sample
align <- read.csv("data/Total_number_of_reads_by_sample.csv")  # Ensure the file is in the 'data/' folder
map <- data.frame(align)
```

## **üìç 3. Define Color Palettes**
```{r define-colors, echo=TRUE}
# Define color palettes for plots
drug_palc <- c("#8B006D","#DF707E","#F1B72B", "#3386DD","#707031","#41B333")
Ind_palc <- c("#ffbe0b","#ff006e","#fb5607", "#8338ec","#3a86ff","#4a4e69")
Time_palc <- c("#0000FF","#80FF00", "#FF00FF")
Combined_palc <- c("#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF",
                   "#FFA500","#800080","#FFC0CB","#A52A2A","#808080","#FFD700",
                   "#008080","#000080","#FFFFFF","#000000","#D2691E","#ADFF2F")
```

## **üìç 4. Prepare Data**
```{r prepare-data, echo=TRUE}
# Factor Sample_name to maintain order
map$Sample_name <- factor(map$Sample_name, levels = map$Sample_name)
```

## **üìç 5. Plot Total Reads by Sample**
```{r plot-total-reads, echo=TRUE, message=FALSE, warning=FALSE,fig.height=8,fig.width=18}
# Generate the bar plot
p <- ggplot(map, aes(x = Sample_name, y = Counts, fill = Condition)) +
  geom_col() +
  scale_fill_manual(values = drug_palc) +
  scale_y_continuous(labels = function(x) paste0(x / 1e6, "M")) +
  ggtitle(expression("Total number of reads by sample")) +
  xlab("") +
  ylab(expression("RNA-sequencing reads")) +
  theme_bw() +
  theme(
    plot.title = element_text(size = rel(2), hjust = 0.5),
    axis.title = element_text(size = 15, color = "black"),
    axis.ticks = element_line(linewidth = 1.5),
    axis.line = element_line(linewidth = 1.5),
    axis.text.y = element_text(size = 10, color = "black", angle = 0, hjust = 0.8, vjust = 0.5),
    axis.text.x = element_text(size = 10, color = "black", angle = 90, hjust = 1, vjust = 0.2)
  )

# Save the plot as an image
ggsave("output/total_reads_by_sample_plot.png", p)

# Display the plot in the document
p
```

